<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Travel Planner</title>
</head>
<body>
    <h1>Smart Travel Planner</h1>
    <h2>Masaki Shibata</h2>

    <form method="post" id="travel-form" style="display: flex; flex-direction: column; width: 300px;">
        {% csrf_token %}
        <label for="start_city">Select start city:</label>
        <select name="start_city" id="start_city" style="margin-bottom: 10px;">
            {% for city in cities %}
                <option value="{{ city.name }}" {% if form.start_city.value == city.name %}selected{% endif %}>{{ city.name }}</option>
            {% endfor %}
        </select>

        <label for="end_city">Select end city:</label>
        <select name="end_city" id="end_city" style="margin-bottom: 10px;">
            {% for city in cities %}
                <option value="{{ city.name }}" {% if form.end_city.value == city.name %}selected{% endif %}>{{ city.name }}</option>
            {% endfor %}
        </select>

        <button type="submit">Submit</button>
    </form>

    {% if weather_start %}
        <h3>Start City: {{ form.start_city.value }}</h3>
        <p>Weather: {{ weather_start.temperature }}°C, {{ weather_start.description }}</p>

        <h3>End City: {{ form.end_city.value }}</h3>
        <p>Weather: {{ weather_end.temperature }}°C, {{ weather_end.description }}</p>

        <h3>Recommended Route:</h3>
        <p>Distance: {{ route_details.distance }} km</p>
        <p>Estimated driving time: {{ route_details.duration }} minutes</p>
        
        <h4>Route Steps:</h4>
        <ol>
            {% for step in route_details.steps %}
                <li>{{ step.instruction }} for {{ step.distance }} km</li>
            {% endfor %}
        </ol>

        <p><strong>Advice:</strong> {{ travel_advice }}</p>
        
        <button type="submit" name="save_query" value="1" form="travel-form">Save query to history</button>
    {% endif %}

    <p><a href="{% url 'travel:history' %}">View History</a></p>
</body>
</html>
